language: android
android:
  components:
    - tools
    - platform-tools
  licenses:
    - android-sdk-license
    - android-sdk-license-.+
    - android-sdk-preview-license
    - android-sdk-preview-license-.+
before_install:
  - yes | sdkmanager "platforms;android-30"
  - yes | sdkmanager "build-tools;30.0.3"
  - openssl aes-256-cbc -K $encrypted_3526efccafd4_key -iv $encrypted_3526efccafd4_iv
    -in release.jks.enc -out release.jks -d
  - openssl aes-256-cbc -K $encrypted_3526efccafd4_key -iv $encrypted_3526efccafd4_iv
    -in app/src/debug/google-services.json.enc -out app/src/debug/google-services.json -d
  - openssl aes-256-cbc -K $encrypted_3526efccafd4_key -iv $encrypted_3526efccafd4_iv
    -in app/src/release/google-services.json.enc -out app/src/release/google-services.json -d
deploy:
  provider: releases
  cleanup: false
  overwrite: true
  token:
    secure: "PvYfN7XptJCkzLRTyBvdYVCaDOJzAJqLWDdhZ8ea475U4P83hRzkRsUzCNR6MH8VO4LCIEHiv5Wr3wfLBqSfzXJQQPGCxfAk9z95lnYsLM6ot/9zZita2gnKgBUZtQ1U2df44G1oI+Y8LfOf0ePthIFbzvJxfhN09Efqk+N7UPODAnBy1pohRILgsHrK9voL25lSxPFW33Zo18O9Oihys+F8zXFX2jXsFSg5jTF7j95nYvka/PhK5ZKhGDW+eTZ+L/QZhc7hUdkUw1NXP6A8M+lRc0p4dGWmexJj8QVax9BgzX6OV2IYFfwHja8hDn/IZpIFyV6BZ9Mzl6B0GMdqrKRmLsoJ50/nvoXe8EG2PuXUmI+C4PAREHXQn/I1jwQccGIWQHe6xAjdR/s1c6m7NgzExeZimWt1RF6Ejp0Ga8863DEP9x0FLoOcbDWLaGLaM5P/uElEy6VLiV21LnEh4NAgkfwbuDI86oteBTbnScl2cye/oEEnQvLtM/14lquNjgSXMihVxQYlyjQR8JbOzffbbALlPwpmdjrsQuWYJ2yIEOgV5oOj7rKUzIhyVwMEvhlAyuKoNaH2QP2g2B/RQF82p6tnTi83dpsOBdQHTcSaAuIVqxjIAgdG2jtAPquvPWsVCgxoPlqohdwIIWWxZpVY4Vj4ikb/nShsy6A3DuM="
  file_glob: true
  file: "app/build/outputs/apk/release/app-release.apk"
  on:
    repo: PSDev/DevDrawer
    tags: true
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
